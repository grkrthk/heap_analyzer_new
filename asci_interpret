






















































































































































































































































































































































































!
main thread

@C
!
errmsg
1
dropmsgswithmali
ciousdnsptrrecor
ds!
var
P=B

!
module
!
glbl

Q

!


workdirectory
!

!



!


defaultnetstream
driver!

!


defaultnetstream
drivercafile
!

!


defaultnetstream
driverkeyfile
!

!


defaultnetstream
drivercertfile
!

!

`6d!

optimizeforunipr
ocessor!

!

d6d!

hupisrestart
!

!


preservefqdn
!

!
!
resetconfigvaria
bles!

!
datetime
1
0!
msg
u[C
pdA
!
strm
)FC
 .B
`RB
!
wti
!
wtp
`EB
!
qqueue
!
vmstk
`tBtB
prB
!
sysvar
!
vm
@cB
!
vmop
!
vmprg
!
ctok_token
@+B
!
ctok
RC
p*B*B
!
expren
B
!
confen

!
 !
SEL1110170128
1


1
/usr/lib/rsyslog
/lmnet.so

























@










/usr/lib
/rsyslog/lmnet.s
o1
/usr/lib/rsyslog
lmnet.so
A










!
net
1
0!
lmnet
SEL1110170128








ff02::3 ip6-all
hostsalhost
ip6-loopback

























































1

!
!
/lib/libnss_file
s.so.2!
/liblibnss_file
s.so.2A



1

!
!
/lib/libnss_dns.
so.2!
/liblibnss_dns.
so.2!
/lib/libresolv.s
o.2les!
/liblibresolv.s
o.2abouA
@Q


Q


1
Q



1
Q

Q


1
Q



1
sQ


Q



1
Q


Q



1
Q


Q



1
Q


Q



1
Q



























@









	
libnss_f
iles.so.2



































libnss_d























	
@










libresol
v.so.2Q






ri	


 A A
pA0A
'A

1
actionfiledefaul
ttemplate
Q

!
dynafilecachesiz
e!

!

L]d!
dirowner
!

!

P]d!
dirgroup
!

!

D]d!
fileowner
!

!

H]d!
filegroup
!

!

05d!
dircreatemode
!

!

45d!
filecreatemode
!

!

T]d!
createdirs
!

!

@]d!
failonchownfailu
re!

!

(]d!
actionfileenable
sync!

!

0]d!

!
builtin-file

A


1
actionforwarddef
aulttemplate


!


!


actionsendstream
driver!

!

]d!

actionsendstream
drivermode
!

!

]d!

actionsendstream
driverauthmode
!

!
!

actionsendstream
driverpermittedp
eer!

!

]d!

actionsendresend
lastmsgonreconne
ct!
pA
!
builtin-fwd



1
mainmsgqueuehigh
watermark
builtin-shell

p,A

.A

!
builtin-discard



!
builtin-usrmsg
Q

!


actionresumeretr
ycount!

!


mainmsgqueuefile
name!

!

()d!

mainmsgqueuesize
!

!

,)d!


!

0)d!

mainmsgqueueloww
atermark
!

!

4)d!

mainmsgqueuedisc
ardmark!

!


8)d!

mainmsgqueuedisc
ardseverity
!

!


mainmsgqueuechec
kpointinterval
!

!
!

mainmsgqueuetype
!

!

<)d!

mainmsgqueuework
erthreads
!

!


mainmsgqueuetime
outshutdown
!

!

@)d!

mainmsgqueuetime
outactioncomplet
ion!

!

D)d!

mainmsgqueuetime
outenqueue
!

!

H)d!

mainmsgqueuework
ertimeoutthreads
hutdown!

!


mainmsgqueuedequ
eueslowdown
!

!

L)d!

mainmsgqueuework
erthreadminimumm
essages!

!

P)d!

mainmsgqueuemaxf
ilesize!

!


mainmsgqueuemaxd
iskspace
!

!

X)d!

mainmsgqueuesave
onshutdown
!

!


mainmsgqueuedequ
euetimebegin
!

!

\)d!

mainmsgqueuedequ
euetimeend
!

!


repeatedmsgreduc
tion!

!


actionexeconlywh
enpreviousissusp
ended!

!

\\d!

actionexeconlyon
ceeveryinterval
!

!
!

actionresumeinte
rval!

!


controlcharacter
escapeprefix
!

!


escapecontrolcha
ractersonreceive
!

!


droptrailinglfon
reception
!

!
!

template
!

!
!

outchannel
!

!
!

allowedsender
!

!
0VA
!

modload
!

!
!

includeconfig
!

!
!

umask
!

!

`)d!

debugprinttempla
telist!

!

d)d!

debugprintmodule
list!

!

h)d!

debugprintcfsysl
inehandlerlist
!

!

`gd!

moddir
!
!

!

l)d!

errormessagestos
tderr!

!
!

maxmessagesize
!

!


privdroptouser
!

!


privdroptouserid
!

!


privdroptogroup
!

!


privdroptogroupi
d!

!

hd!

actionqueuefilen
ame!

!

pZd!

actionqueuesize
!

!

hd!

actionqueuemaxdi
skspace!

!

tZd!

actionqueuehighw
atermark
!

!

xZd!

actionqueuelowwa
termark!

!

|Zd!

actionqueuedisca
rdmark!

!


actionqueuedisca
rdseverity
!

!

hd!

actionqueuecheck
pointinterval
!

!
!

actionqueuetype
!

!


actionqueueworke
rthreads
!

!

hd!

actionqueuetimeo
utshutdown
!

!


actionqueuetimeo
utactioncompleti
on!

!


actionqueuetimeo
utenqueue
!

!


actionqueueworke
rtimeoutthreadsh
utdown!

!


actionqueueworke
rthreadminimumme
ssages!

!


actionqueuemaxfi
lesize!

!


actionqueuesaveo
nshutdown
!

!

hd!

actionqueuedeque
ueslowdown
!

!

hd!

actionqueuedeque
uetimebegin
!

!


actionqueuedeque
uetimeend
!

!


actionexeconlyev
erynthtime
!

!


actionexeconlyev
erynthtimetimeou
t!

!


repeatedmsgconta
insoriginalmsg
!
























!
RSYSLOG_DebugFor
mat1
RSYSLOG_SyslogPr
otocol23Format
 1
RSYSLOG_Traditio
nalFileFormat
 A
inputunixlistens
ocketignoremsgti






A
Debug line with 
all properties:

FROMHOST: '












!
fromhost
!
', fromhost-ip: 












!
fromhost-ip
!
', HOSTNAME: '












!
hostname
!
', PRI: 












!
pri
!
,
syslogtag '












!
syslogtag
!
', programname: 












!
programname
!
', APP-NAME: '












!
app-name
!
', PROCID: '












!
procid
!
', MSGID: '












!
msgid
!
',
TIMESTAMP: '












!
timestamp
!
', STRUCTURED-DA












!
structured-data
!
',
msg: '












!
msg
!
'
escaped msg: '












!
msg
!
'
rawmsg: '













!
rawmsg
!
'


A
1
RSYSLOG_Traditio
nalForwardFormat






!
<












!
pri
!
>1 












!
timestamp
!
 












!
hostname
!
 












!
app-name
!
 












!
procid
!
 












!
msgid
!
 












!
structured-data
!
 













!
msg
!


A
!
RSYSLOG_FileForm












!
timestamp
!
 












!
hostname
!
 












@!
syslogtag






!
msg







!
msg
!


A












!
timestamp
1
/usr/lib/rsyslog
/imuxsock.so
 !
 












!
hostname
!
 












@!
syslogtag






!
msg







!
msg
!


A
!
 WallFmt






1

Message from 
syslogd@












!
hostname
!
 at 












!
timegenerated
!
 ...
 












!
syslogtag







!
msg
!


A
!
RSYSLOG_ForwardF






!
<












!
pri
!
>












!
timestamp
!
 












!
hostname
!
 












@!
syslogtag







!
msg






!
msg
A
1
/usr/lib/rsyslog
imuxsock.sosag
0!
<












!
pri
!
>












!
timestamp
!
 












!
hostname
!
 












@!
syslogtag







!
msg






!
msg
A
!
 StdUsrMsgFmt
!
 












!
syslogtag







!
msg
!


A
!
 StdDBFmt






!
!
!
syslogfacility






insert into Syst
emEvents (Messag
e, Facility, Fro
mHost, Priority,
 DeviceReportedT
ime, ReceivedAt,
 InfoUnitID, Sys
LogTag) values (


















!
, '












!
hostname
!
', 












!
syslogpriority
!
, '












!
timereported
!
', '












!
timegenerated
!
', 












!
iut
!
, '













!
syslogtag
!
')
A
!
 StdPgSQLFmt






!
!
!
syslogfacility






insert into Syst
emEvents (Messag
e, Facility, Fro
mHost, Priority,
 DeviceReportedT
ime, ReceivedAt,
 InfoUnitID, Sys
LogTag) values (


















!
, '












!
hostname
!
', 












!
syslogpriority
!
, '












!
timereported
!
', '












!
timegenerated
!
', 












!
iut
!
, '













!
syslogtag
!
')
!
















!
/lib/libgcc_s.so
.1!
rsyslogd0128
 Q
<30>Mar 11 20:50
:52 ntpd[3674]: 
synchronized to 
91.189.94.4, str
SEL1110170128 nt
pd[3674]: synchr
onized to 91.189
.94.4, stratum 2

s 11

























@









. 

/usr/lib
/rsyslog/imuxsoc
k.soq







!


!
omitlocallogging
!

!


!

systemlogsocketn
ame!

!

inputunixlistens
ockethostname
!

!

inputunixlistens
ocketflowcontrol
!

!
!
addunixlistensoc
ket!
!

!
!
systemlogsocketi
gnoremsgtimestam
p!

!
!
systemlogsocketf
lowcontrol
!
imuxsock
1
/usr/lib/rsyslog
/imklog.so

























@






I@




/usr/lib
/rsyslog/imklog.
so1
/usr/lib/rsyslog
imklog.so
A







1
klogpermitnonker
nelfacility


!
debugprintkernel
symbols!

!

klogpath
!

!

klogsymbollookup
!

!

klogsymbolstwice
!

!

klogusesyscallin
terface!

!


!
	
kloginternalmsgf
acility!
!
imklog
1

/liblibnss_comp
at.so.2!
/lib/libnsl.so.1
!
/liblibnsl.so.1
1
/proc/kmsg
1
RSYSLOG_Traditio
nalFileFormat
!
!
/lib/libnss_comp


































libnss_c
ompat.so.2























	
@










libnsl.s
o.1Q








1

!
!
!
/lib/libnss_nis.
























@










libnss_n
is.so.2!
/liblibnss_nis.
so.2a




!
1
!
1
!
1

!
1

!
Q



!
1

!
1
!
1

!
1


1










!





!
 !




1
/var/log/auth.lo
g












!





6wS

uS



1


!

d


























!
!
action 1 queue
1





1
/var/log/syslog














!




uS



1


!

d


























!
!
action 2 queue
1






1
/var/log/daemon.
log












!

,wS,wS

JwS

uS



1


!

d


























!
!
action 3 queue
1






1
/var/log/kern.lo
g













!




uS



1


!

d


























!
!
action 4 queue
1






1
/var/log/lpr.log














!





uS



1


!

d


























!
!
action 5 queue
1






1
/var/log/mail.lo
g










	


!





uS



1


!

d


























!
!
action 6 queue
1






1
/var/log/user.lo
g












!

	wS	wS

'wS

uS



1


!

d


























!
!
action 7 queue
1







1
/var/log/mail.in
fo













!





uS



1


!

d


























!
!
action 8 queue
1







1
/var/log/mail.wa
rn













!





uS



1


!

d


























!
!
action 9 queue
1







1
/var/log/mail.er
r













!





uS



1


!

d


























!
!
action 10 queue
1







1
/var/log/news/ne
ws.crit













!





uS



1


!

d


























!
!
action 11 queue
1







1
/var/log/news/ne
ws.err













!





uS



1


!

d


























!
!
action 12 queue
1



?



1
/var/log/news/ne
ws.notice













!





uS



1


!

d


























!
!
action 13 queue
1





1
/var/log/debug













!

uSuS

0uS

uS



1


!

d


























!
!
action 14 queue
1



pppppppppp
ppppppppp


1
/var/log/message
s













!




uS



1


!

d


























!
!
action 15 queue
1







!
main queue:Reg











!
main queue




uS



!

d


























!
!
action 16 queue
1






1
/dev/xconsole













1
main queue:Reg/w
0lFileFormat
0











	wS
+


2


!
/etc/localtime
!

UTC1



S&y
T&y
d^&	
``'	
Q
SEL1110170128 rs
yslogd: /var/log
/daemon.log
s 1
P 
SEL1110170128
 1
rsyslogd's useri
d changed to 101
1
rsyslogd's useri
d changed to 101
!
imuxsock.c
 1
UTCUTC0
,wS,wS

JwS

uS



1


!

d


























!
!
action 17 queue
1



'
d






R)
))















2












uS
+


)


A
imklog: Cannot r
ead proc file sy
stem, 1.

A
imklog: Cannot r
ead proc file sy
stem, 1.

A
imklog: Cannot r
ead proc file sy
stem, 1.

!
SEL1110170128
!
!
SEL1110170128
!
!
127.0.0.1
1
Mar 11 20:50:17
 91.189.94.4, st
0!
Mar 11 20:41:47
!
 !
SEL1110170128
 !
ntpd[3674]:
SEL111011
0<
0 
rsyslogd:128
a
 FATAL ERROR:  C
ould not open IR
IG driver for re
ad/write!  Termi
nating applicati
on!
SEL1110170128
 !
SEL1110170128
 











uS
)/7
+


)
/7+


!
 q
Mar 11 20:41:54 
ntpd[3674]: ntp_
io: estimated ma
x descriptors: 1
024, initial soc
ket boundary: 16
ri Aug Q
 ntp_io: estimat
ed max descripto
rs: 1024, initia
l socket boundar
y: 16!
SEL1110170128
!
SEL1110170128
!
SEL1110170128
 !
SEL1110170128
 q
<31>Mar 11 20:41
:54 ntpd[3674]: 
ntp_io: estimate
d max descriptor
s: 1024, initial
 socket boundary
: 16!
rsyslogd
!

















!
Mar 11 20:41:54
SEL11101!
login[3776]:
Mar 11 20:50:17 
irigd: FATAL ERR
OR:  Could not o
pen IRIG driver 
for read/write! 
 Terminating app
licationtp.drif
t1
00


A
 1
Mar 11 20:41:47
1
rsyslogd's useri
d changed to 101













wS
+


2


<11>Mar 11 20:50
:17 irigd: FATAL
 ERROR:  Could n
ot open IRIG dri
ver for read/wri
te!  Terminating
 application
<85>Mar 11 20:50
:32 login[3776]:
 ROOT LOGIN  on 
'/dev/tty1'
`1
 synchronized to
 91.189.94.4, st
ratum 2











uS
)6O.
+


)
6O.+


!
!
/liblibgcc_s.so
.1!
SEL1110170128
 !



















































































































































































































